<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>기록 시스템</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    input, textarea, button { margin: 5px; }
    .record { margin: 10px 0; width: 600px; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
  </style>
</head>
<body>
  <h1>사람 정보 기록</h1>
  
  <input type="text" id="name" placeholder="이름"><br>
  <textarea id="content" rows="4" cols="80" placeholder="내용을 입력하세요"></textarea><br>
  <button onclick="submitData()">기록하기</button>
  <button onclick="queryData()">조회하기</button>
  <button onclick="queryAll()">전체조회</button>

  <div id="result"></div>

  <script>
    const ENDPOINT = 'https://script.google.com/macros/s/AKfycbzhjlm1ttbOap78ATUc1jM1Shc5iUgy4loVOV7UW9QTKrQJ-FKNtiCaoM4CuI2h4AW4/exec';

    function submitData() {
      const name = document.getElementById('name').value.trim();
      const content = document.getElementById('content').value.trim();

      if (!name || !content) return alert("이름과 내용을 입력하세요.");

      fetch(ENDPOINT, {
        method: "POST",
        body: JSON.stringify({ name, content }),
        headers: { "Content-Type": "application/json" }
      })
      .then(res => res.json())
      .then(() => {
        alert("기록 완료");
        document.getElementById('content').value = '';
      });
    }

    function queryData() {
      const name = document.getElementById('name').value.trim();
      if (!name) return alert("이름을 입력하세요.");

      fetch(`${ENDPOINT}?name=${encodeURIComponent(name)}`)
        .then(res => res.json())
        .then(showData);
    }

    function queryAll() {
      fetch(ENDPOINT)
        .then(res => res.json())
        .then(showData);
    }

    function showData(data) {
      const result = document.getElementById('result');
      result.innerHTML = '';

      if (data.length === 0) {
        result.textContent = "결과가 없습니다.";
        return;
      }

      data.forEach(item => {
        const div = document.createElement('div');
        div.className = "record";
        div.innerHTML = `<strong>${item.name}</strong><br>${item.content}<br><small>${item.timestamp}</small>`;
        result.appendChild(div);
      });
    }
  </script>
</body>
</html>
